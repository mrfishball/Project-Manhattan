<!DOCTYPE html>

<html>
	<head>
		<title>A Simple Map</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,300i,400,400i,700,700i" rel="stylesheet">

		<link rel="stylesheet" href="static/css/style.css">
	</head>
	<body>
		<div id="wrapper">
			<header class="header">
		    <nav class="header-nav">
	     		<div id="hamburger-menu" class="slider"></div>
	     		<input id="pac-input" class="controls" type="text" placeholder="Search Maps">
		    </nav>
		  </header><!--header -->
			<main class="content">
		    <div class="container">
		    	<div id="map"></div>
		    </div><!-- container -->
		  </main><!-- content -->
		 </div><!-- wrapper -->

		 <nav id="menu-slide-left" class="menu menu-slide-left">
		  <ul class="menu-items">
		    <!-- <li class="menu-item"><a href="#" class="menu-link">Home</a></li>
		    <li class="menu-item"><a href="#" class="menu-link">About</a></li>
		    <li class="menu-item"><a href="#" class="menu-link">Services</a></li>
		    <li class="menu-item"><a href="#" class="menu-link">Work</a></li>
		    <li class="menu-item"><a href="#" class="menu-link">Contact</a></li> -->
		  </ul>
		</nav><!--Menu slide from left-->

		<nav id="menu-slide-bottom" class="menu menu-slide-bottom">
		  <ul class="menu-items">
<!-- 		    <li class="menu-item"><a href="#" class="menu-link">Home</a></li>
		    <li class="menu-item"><a href="#" class="menu-link">About</a></li>
		    <li class="menu-item"><a href="#" class="menu-link">Services</a></li> -->
		  </ul>
		</nav><!-- Menu slide from bottom -->
		
		<div id="mask" class="mask"></div><!-- mask -->
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
		<script>
			var mapDiv = document.getElementById('map');
			var pos;
			var map;
			$.get( "http://ip-api.com/json", function(data) {
				pos = new google.maps.LatLng(data.lat, data.lon);
				initMap();
			});

			function initMap() {
			  map = new google.maps.Map(mapDiv, {
			    zoom: 16,
          center: pos,
          mapTypeControl: false
			  });

			  // Display user's current location on the map
	       var curr_marker = new google.maps.Marker({
	        position: pos,
	        map: map,
	        draggable: false,
	       animation: google.maps.Animation.DROP,
	        title: 'Gotcha!'
	      });

			  var infowindow = new google.maps.InfoWindow();
			  var service = new google.maps.places.PlacesService(map);
			  service.nearbySearch({
			    location: pos,
			    radius: 500,
			    type: ['store']
			  }, callback);

			  var contentString = '<div id="content">'+
            '<h3>' + 'This is you!' + '</h3>' +
            '</div>';
         var curr_infowindow = new google.maps.InfoWindow();
         curr_infowindow.setContent(contentString);


        curr_marker.addListener('click', function() {
        curr_infowindow.open(map, curr_marker);
        });
        curr_marker.setMap(map);
        curr_infowindow.open(map, curr_marker);
			}

			function callback(results, status) {
			  if (status === google.maps.places.PlacesServiceStatus.OK) {
			    for (var i = 0; i < results.length; i++) {
			      createMarker(results[i]);
			    }
			  }
			}

			function createMarker(place) {
			  var placeLoc = place.geometry.location;
			  var marker = new google.maps.Marker({
			    map: map,
			    position: place.geometry.location
			  });

			  google.maps.event.addListener(marker, 'click', function() {
			    infowindow.setContent(place.name);
			    infowindow.open(map, this);
			  });
			}
    </script>
		<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBoVzrmlxfvUBwId_KoqAF5PBnaHNDOEHU&libraries=places&callback=initMap">
    </script>
		<script type="text/javascript" src="static/js/menu.js"></script>
	</body>
</html>
